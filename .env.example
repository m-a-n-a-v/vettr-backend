# =============================================================================
# VETTR Backend - Environment Configuration
# =============================================================================
# This file documents ALL environment variables used by the VETTR Backend API.
# Copy this file to .env and configure the values for your environment.
#
# REQUIRED vs OPTIONAL:
# - REQUIRED: Must be set in production, has no sensible default
# - OPTIONAL: Has sensible defaults or is only needed for specific features
# - DEV OPTIONAL: Optional in development, required in production
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

# PORT (OPTIONAL)
# The port number the HTTP server will listen on
# Default: 3000
PORT=3000

# NODE_ENV (OPTIONAL)
# The environment the application is running in
# Valid values: development, production, test
# Default: development
# - development: Verbose logging, graceful degradation when services unavailable
# - production: Fail-fast on critical errors, structured JSON logging
# - test: Used by test suite, disables external services
NODE_ENV=development

# API_VERSION (OPTIONAL)
# API version prefix for all routes (informational only)
# Default: v1
# All routes are served under /v1/* prefix
API_VERSION=v1

# -----------------------------------------------------------------------------
# Database Configuration (PostgreSQL)
# -----------------------------------------------------------------------------

# DATABASE_URL (DEV OPTIONAL, PRODUCTION REQUIRED)
# PostgreSQL connection string.
#
# Works with both:
# - Local Docker Postgres: postgresql://vettr:vettr_dev@localhost:5432/vettr
# - Neon cloud Postgres: postgresql://user:pass@host.neon.tech/db?sslmode=require
#
# Local Development:
# 1. Run: docker compose up -d
# 2. Use: postgresql://vettr:vettr_dev@localhost:5432/vettr
#
# Production (Neon):
# 1. Sign up at https://neon.tech
# 2. Create a new project
# 3. Copy the connection string (include ?sslmode=require)
#
# Development: Optional - app will start without database (DB features disabled)
# Production: Required - app will exit if not provided or connection fails
DATABASE_URL=postgresql://vettr:vettr_dev@localhost:5432/vettr

# -----------------------------------------------------------------------------
# Authentication Configuration
# -----------------------------------------------------------------------------

# JWT_SECRET (DEV OPTIONAL, PRODUCTION REQUIRED)
# Secret key used to sign and verify JSON Web Tokens
# MUST be a long, random, cryptographically secure string
#
# How to generate:
# - Run: openssl rand -base64 64
# - Or use: node -e "console.log(require('crypto').randomBytes(64).toString('base64'))"
#
# Default (DEV ONLY): 'development-secret-change-in-production'
# Production: MUST be set to a secure random value (min 64 characters recommended)
# WARNING: Never commit production secrets to version control!
JWT_SECRET=local-dev-secret-change-in-production

# JWT_ACCESS_EXPIRY (OPTIONAL)
# Access token time-to-live (used for API authentication)
# Format: number + unit (s=seconds, m=minutes, h=hours, d=days)
# Default: 15m (15 minutes)
# Note: Hardcoded in jwt.ts, documented here for reference
JWT_ACCESS_EXPIRY=15m

# JWT_REFRESH_EXPIRY (OPTIONAL)
# Refresh token time-to-live (used to obtain new access tokens)
# Format: number + unit (s=seconds, m=minutes, h=hours, d=days)
# Default: 30d (30 days)
# Note: Hardcoded in jwt.ts, documented here for reference
JWT_REFRESH_EXPIRY=30d

# -----------------------------------------------------------------------------
# Redis Cache Configuration
# -----------------------------------------------------------------------------

# REDIS_URL (DEV OPTIONAL, PRODUCTION RECOMMENDED)
# Standard Redis connection URL. Works with any Redis provider.
#
# Works with both:
# - Local Docker Redis: redis://localhost:6379
# - Upstash TCP endpoint: rediss://default:token@host.upstash.io:6379
#
# Local Development:
# 1. Run: docker compose up -d
# 2. Use: redis://localhost:6379
#
# Production (Upstash):
# 1. Sign up at https://upstash.com
# 2. Create a new Redis database
# 3. Copy the TCP/TLS connection URL (NOT the REST URL)
#
# Development: Optional - caching will be disabled, rate limiting will be skipped
# Production: Recommended - improves performance and enables rate limiting
REDIS_URL=redis://localhost:6379

# RATE_LIMIT_ENABLED (OPTIONAL)
# Enable or disable rate limiting globally
# Default: true (rate limiting enabled)
# Note: Rate limiting requires Redis to be configured
# If Redis is unavailable, rate limiting is automatically disabled
RATE_LIMIT_ENABLED=true

# -----------------------------------------------------------------------------
# OAuth Configuration (Social Sign-In)
# -----------------------------------------------------------------------------

# GOOGLE_CLIENT_ID (OPTIONAL)
# Google OAuth 2.0 Client ID for Sign in with Google
#
# Where to get it:
# 1. Go to https://console.cloud.google.com
# 2. Create a new project or select existing
# 3. Enable "Google+ API" or "Google Identity Services"
# 4. Go to "Credentials" > "Create Credentials" > "OAuth client ID"
# 5. Choose "Web application" as application type
# 6. Add authorized redirect URIs (your frontend callback URLs)
# 7. Copy the "Client ID" (format: xxxxxx.apps.googleusercontent.com)
#
# Development: Optional - Google sign-in will be disabled
# Production: Optional - only needed if supporting Google authentication
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com

# APPLE_CLIENT_ID (OPTIONAL)
# Apple Service ID for Sign in with Apple
#
# Where to get it:
# 1. Go to https://developer.apple.com/account
# 2. Navigate to "Certificates, Identifiers & Profiles"
# 3. Create a Services ID (different from your App ID/Bundle ID)
# 4. Enable "Sign in with Apple" capability
# 5. Configure domains and redirect URLs
# 6. The Services ID is your APPLE_CLIENT_ID
#
# Development: Optional - Apple sign-in will be disabled
# Production: Optional - only needed if supporting Apple authentication
APPLE_CLIENT_ID=com.vettr.services

# -----------------------------------------------------------------------------
# CORS Configuration
# -----------------------------------------------------------------------------

# CORS_ORIGIN (OPTIONAL)
# Allowed origins for Cross-Origin Resource Sharing (CORS)
# Controls which domains can make requests to this API
#
# Formats:
# - Single origin: https://app.vettr.com
# - Multiple origins: https://app.vettr.com,https://admin.vettr.com
# - All origins: * (use with caution in production!)
#
# Default: * (allow all origins)
# Development: * is fine for local testing
# Production: Set to your specific frontend domain(s) for security
CORS_ORIGIN=*

# =============================================================================
# Admin Configuration
# =============================================================================

# ADMIN_SECRET (OPTIONAL)
# Secret key for admin-only endpoints (X-Admin-Secret header)
# Used for monitoring, metrics, and administrative operations
ADMIN_SECRET=

# =============================================================================
# Quick Start Guide
# =============================================================================
#
# MINIMAL SETUP (Local Development):
# 1. Copy this file: cp .env.example .env
# 2. Run: docker compose up -d (starts Postgres + Redis)
# 3. Run: npm install
# 4. Run: npm run db:push (creates database tables)
# 5. Run: npm run db:seed (seeds sample data)
# 6. Run: npm run dev
# 7. API available at http://localhost:3000/v1/health
#
# FULL SETUP (Production-Ready):
# 1. Set up PostgreSQL (Neon recommended) and set DATABASE_URL
# 2. Set up Redis (Upstash recommended) and set REDIS_URL
# 3. Generate secure JWT_SECRET (see command above)
# 4. Configure OAuth if needed (GOOGLE_CLIENT_ID, APPLE_CLIENT_ID)
# 5. Set CORS_ORIGIN to your frontend domain(s)
# 6. Set NODE_ENV=production
# 7. Run: npm run build && npm start
#
# =============================================================================
# Security Checklist
# =============================================================================
#
# [ ] JWT_SECRET is set to a secure random value (NOT the default)
# [ ] .env file is in .gitignore (NEVER commit secrets to git)
# [ ] DATABASE_URL uses SSL mode for production (?sslmode=require)
# [ ] CORS_ORIGIN is restricted to your actual frontend domain(s)
# [ ] Production environment variables are stored securely (e.g., Railway secrets)
# [ ] Rotate JWT_SECRET periodically (requires all users to re-authenticate)
# [ ] Never log environment variables or tokens in production
#
# =============================================================================
